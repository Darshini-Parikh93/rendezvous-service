// Copyright 2019 Intel Corporation
// SPDX-License-Identifier: Apache 2.0

package org.sdo.rendezvous.utils;

import java.util.stream.Collectors;
import java.util.stream.Stream;
import javax.xml.bind.DatatypeConverter;
import org.mockito.InjectMocks;
import org.mockito.MockitoAnnotations;
import org.sdo.rendezvous.exceptions.FailedCertChainVerificationException;
import org.sdo.rendezvous.model.types.Cert;
import org.sdo.rendezvous.model.types.CertChain;
import org.sdo.rendezvous.model.types.CertType;
import org.sdo.rendezvous.utils.validators.CertChainValidator;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

public class CertChainValidatorTest {

  private static final byte[] LEAF_CERT_384 =
    DatatypeConverter.parseHexBinary(
        "308203083082028ea003020102021455a618e1e96bd2f7d52a2e82616b0b582575f3b0300a06082a8648ce"
            + "3d040303308183310b3009060355040613025553310b300906035504080c0243413114301206035504"
            + "070c0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f"
            + "6e311d301b060355040b0c14494f542043414b2049737375696e672043412030311630140603550403"
            + "0c0d7777772e696e74656c2e636f6d301e170d3138313031363130333130335a170d32383038323431"
            + "30333130335a301d311b301906035504030c12496f542043414b207669643a30444444414130763010"
            + "06072a8648ce3d020106052b81040022036200049c284ca00c258b8edc8698021906c2dfd67e879b6f"
            + "ad25433aa278204a44fbb96f749d754dec9af13ac6fcde6d8c5ffc12a233b7995cb100277d6800ed9a"
            + "6018143bcf2473a59a5a7072e37788406aa5346d6b05a19e4dc210fc38966d65d264a3820126308201"
            + "22306e06082b0601050507010104623060305e06082b06010505073002865268747470733a2f2f7472"
            + "757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f542f6365727473"
            + "2f494f545f43414b5f526f6f7443415f43657274696669636174652e636572301f0603551d23041830"
            + "16801464cb77ba05f00adf9078e372f113f682d5f8932630120603551d130101ff040830060101ff02"
            + "0100304f0603551d1f044830463044a042a040863e68747470733a2f2f747275737465647365727669"
            + "6365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63726c732f494f545f43414b2e6372"
            + "6c300b0603551d0f040403020186301d0603551d0e04160414d0ae387801e37f39c58b269fc0d9a93c"
            + "261dc4d7300a06082a8648ce3d0403030368003065023100c5e49b2dacc319f9b611064da664dfe22c"
            + "0b09aa52a87832a085f5838b9b7509e68fead4b138a3c6ad069ba93bd5622d0230706ee835f1e8d253"
            + "3e728e63970300c3650d9c6ad524e1970cdc6db5b858e0187541ccb1246a921768281c5b4095f243");

  private static final byte[] ISSUER_CERT_384 =
    DatatypeConverter.parseHexBinary(
        "30820373308202f8a003020102021400fc21da71f6203e3bb5d38c18ee6748c112b59b300a06082a8648ce"
            + "3d040303308183310b3009060355040613025553310b30090603550408130243413114301206035504"
            + "07130b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f"
            + "6e311d301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403"
            + "130d7777772e696e74656c2e636f6d301e170d3138313031303039333731375a170d32383038313830"
            + "39333731375a308183310b3009060355040613025553310b300906035504080c024341311430120603"
            + "5504070c0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174"
            + "696f6e311d301b060355040b0c14494f542043414b2049737375696e67204341203031163014060355"
            + "04030c0d7777772e696e74656c2e636f6d3076301006072a8648ce3d020106052b8104002203620004"
            + "fdc38232e8197b3b6e5ba91d0ca249aab3d29de4ad5b304cfb0c986653b8ec9e618bae918204410ea4"
            + "ae05d04e221929153df7205c840e2ddf64244c5b20fa3b8acdc8ea109522de927b80910f2213cd1e5a"
            + "c14fa1cffdd01203aa9d7338009ba382012930820125306e06082b0601050507010104623060305e06"
            + "082b06010505073002865268747470733a2f2f7472757374656473657276696365732e696e74656c2e"
            + "636f6d2f636f6e74656e742f494f542f63657274732f494f545f43414b5f526f6f7443415f43657274"
            + "696669636174652e636572301f0603551d230418301680142f2185911c74008cdd951ca759a421f4fc"
            + "b1283630120603551d130101ff040830060101ff020100304f0603551d1f044830463044a042a04086"
            + "3e68747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e"
            + "742f494f542f63726c732f494f545f43414b2e63726c300e0603551d0f0101ff040403020106301d06"
            + "03551d0e0416041464cb77ba05f00adf9078e372f113f682d5f89326300a06082a8648ce3d04030303"
            + "69003066023100b6ed8a4b7ba689667cf1a7178705ee0e9fef0526c19289ee94dbf93587cbefedcfcf"
            + "a6ae0ab56061b136a7e1fead18d8023100e4742b237fe03f3676016a861f8f656cbeab29f3edca57f4"
            + "ae96abacfad73b60fbadbb74d673388fc09194c2f7f6fdf8");

  private static final byte[] ROOT_CERT_384 =
    DatatypeConverter.parseHexBinary(
        "308202983082021da00302010202146e1dcdc44c461e0e120ee340d64494bf7f75ccc6300a06082a8648ce"
            + "3d040303308183310b3009060355040613025553310b30090603550408130243413114301206035504"
            + "07130b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f"
            + "6e311d301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403"
            + "130d7777772e696e74656c2e636f6d301e170d3138313031303039333631355a170d32383038313830"
            + "39333631355a308183310b3009060355040613025553310b3009060355040813024341311430120603"
            + "550407130b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174"
            + "696f6e311d301b060355040b1314494f542043414b20526f6f74205369676e696e6731163014060355"
            + "0403130d7777772e696e74656c2e636f6d3076301006072a8648ce3d020106052b8104002203620004"
            + "399d2d79cc13381e26c224a293a8272037421b4c580e839e9f4e03ccc6d7b19376c5e8639d826b165e"
            + "ff8be0b92236871de1b9bbd554e3ad13015b7d80789164a4aaaa071b3158b5817f22c1e4601fe344f8"
            + "bfaf5ce321811f8fbd5b62a9f80ea350304e30090603551d230402300030120603551d130101ff0408"
            + "30060101ff020101300e0603551d0f0101ff040403020106301d0603551d0e041604142f2185911c74"
            + "008cdd951ca759a421f4fcb12836300a06082a8648ce3d0403030369003066023100c21654fbb293b5"
            + "a1cf0bb865aa63d09d54ac19a9cfd801f6626e4a26ef541866dca3d05a5c96d6e1d7a990aa18641371"
            + "023100d705c867d917f0b451e80ba7222c6ee92b987334440567445941c4c8382cff9564f6dc311544"
            + "5efc674b1f1a1f45d9c3");

  private static final byte[] LEAF_CERT_256 =
    DatatypeConverter.parseHexBinary(
        "308202ce30820274a00302010202141128010222b54c4629a598f681d7bd54a7c7e0c6300a06082a8648ce3"
            + "d040302308183310b3009060355040613025553310b300906035504080c024341311430120603550407"
            + "0c0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e3"
            + "11d301b060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d"
            + "7777772e696e74656c2e636f6d301e170d3138313130353134323931385a170d3238303931333134323"
            + "931385a301d311b301906035504030c12496f542043414b207669643a3044444441413059301306072a"
            + "8648ce3d020106082a8648ce3d0301070342000459c28e249b0a0f6062b2d24cf6c28882c922f8b3679"
            + "b35c6dfcb2ad0ec2af647de6a79bd3bbb27ed977dd5b94b51601d5a069924228660d640fc5becf37368"
            + "16a382012930820125306e06082b0601050507010104623060305e06082b06010505073002865268747"
            + "470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f"
            + "542f63657274732f494f545f43414b5f526f6f7443415f43657274696669636174652e636572301f060"
            + "3551d230418301680147f799ce93f862d482e2098e0af43e2a3da31ee1530120603551d130101ff0408"
            + "30060101ff020100304f0603551d1f044830463044a042a040863e68747470733a2f2f7472757374656"
            + "473657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63726c732f494f545f43"
            + "414b2e63726c300e0603551d0f0101ff040403020186301d0603551d0e041604147f799ce93f862d482"
            + "e2098e0af43e2a3da31ee15300a06082a8648ce3d0403020348003045022100f98611668e8a1dbda0b4"
            + "9e687241f4b79a3b6fb6d6c90ec97b014f3fd86b2ac602204bbc16ce1108fa8a94edccf9f759bd913b3"
            + "74bfb5a58c85ad1872fc9c2aeb929");

  private static final byte[] ISSUER_CERT_256 =
    DatatypeConverter.parseHexBinary(
        "30820334308202dba00302010202144cafdb8c117ed83a8b3b8ac91e3f831cafa9470e300a06082a8648ce3"
            + "d040302308183310b3009060355040613025553310b3009060355040813024341311430120603550407"
            + "130b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e3"
            + "11d301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d"
            + "7777772e696e74656c2e636f6d301e170d3138313130353134323930395a170d3238303931333134323"
            + "930395a308183310b3009060355040613025553310b300906035504080c024341311430120603550407"
            + "0c0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e3"
            + "11d301b060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d"
            + "7777772e696e74656c2e636f6d3059301306072a8648ce3d020106082a8648ce3d03010703420004774"
            + "d6d17aa8f9c3d20bd72f62128be7d327e3299fac9a0abf925a97f488a320ed112cc7a5a2058bcf2def7"
            + "dfa22eb1b2e1af3470646644858cea84cc41fff292a382012930820125306e06082b060105050701010"
            + "4623060305e06082b06010505073002865268747470733a2f2f7472757374656473657276696365732e"
            + "696e74656c2e636f6d2f636f6e74656e742f494f542f63657274732f494f545f43414b5f526f6f74434"
            + "15f43657274696669636174652e636572301f0603551d230418301680147f799ce93f862d482e2098e0"
            + "af43e2a3da31ee1530120603551d130101ff040830060101ff020100304f0603551d1f044830463044a"
            + "042a040863e68747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f"
            + "6e74656e742f494f542f63726c732f494f545f43414b2e63726c300e0603551d0f0101ff04040302010"
            + "6301d0603551d0e041604147f799ce93f862d482e2098e0af43e2a3da31ee15300a06082a8648ce3d04"
            + "03020347003044022011157093e2ca04f838f93ee5e62aee23c057c1931d16b995d7a9c234859a99110"
            + "2202a51fee663c5a0d133ffca39c43a69dd90c8e47f12696592e5f8da452f9a8c6a");

  private static final byte[] ROOT_CERT_256 =
    DatatypeConverter.parseHexBinary(
        "3082025a308201ffa0030201020213621eb990777519661a29db28683a0b94dd1f6f300a06082a8648ce3d04"
            + "0302308183310b3009060355040613025553310b3009060355040813024341311430120603550407130b"
            + "53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d30"
            + "1b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d777777"
            + "2e696e74656c2e636f6d301e170d3138313130353134323835335a170d3238303931333134323835335a"
            + "308183310b3009060355040613025553310b3009060355040813024341311430120603550407130b5361"
            + "6e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d301b06"
            + "0355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777772e69"
            + "6e74656c2e636f6d3059301306072a8648ce3d020106082a8648ce3d030107034200046c95e31ee4d176"
            + "b3047c0788ace3437eecff9f56f4b9ad365d77edddc7ab11bdb68db518d7515023ec89b34a36676651bd"
            + "5640bab3f6d8086f76c83b3a66a5d2a350304e30090603551d230402300030120603551d130101ff0408"
            + "30060101ff020101300e0603551d0f0101ff040403020106301d0603551d0e041604147f799ce93f862d"
            + "482e2098e0af43e2a3da31ee15300a06082a8648ce3d04030203490030460221009e64918976df068622"
            + "6ab15f1245c155d6052a2cf5d8eb8f2dc853fd6c99d22a022100fbc1ed8b5d9ba42a294e7a296de5f27d"
            + "c3f126bc3dd019b8621f500774aaa69b");

  private static final byte[] NO_KEY_USAGE_ROOT_CERT =
    DatatypeConverter.parseHexBinary(
        "308202973082021da00302010202143300aa780e8b0d4f4cca16c3d49ffa6c2719aaf6300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
            + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
            + "772e696e74656c2e636f6d301e170d3138313131343131313631395a170d323830393232313131363139"
            + "5a308183310b3009060355040613025553310b3009060355040813024341311430120603550407130b53"
            + "616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d301b"
            + "060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777772e"
            + "696e74656c2e636f6d3076301006072a8648ce3d020106052b81040022036200040662852b6867440edd"
            + "7f31c5237cd414709acbaf7e14300ae24ca5609f28f6ae554ee7660b36c6348dec61f531b71bef9498db"
            + "138e754059c528e540753c10853a632b9a950aee37ea1d276d7507942bedb63c7fa73b7a2e5b252f5e7d"
            + "362acba350304e30090603551d230402300030120603551d130101ff040830060101ff020101300e0603"
            + "551d0f0101ff040403020106301d0603551d0e04160414ea64e85e9d1901e93b68d7eadf1143eb40417c"
            + "b3300a06082a8648ce3d0403030368003065023100905f6a99b5e9623a135c063a90c3453c6495fe3d8d"
            + "ad3073acca06ea01dcf020a4d55b2e8cde028e0d80c25121c863ac02301e76167ec89a943854ec68efd2"
            + "c22530fc381c055ccf5d04abe38848b6d9d0258deb5a28a7f734a9338c1528ac4a2d5a");

  private static final byte[] NO_KEY_USAGE_ISSUER_CERT =
    DatatypeConverter.parseHexBinary(
        "30820370308202f8a00302010202143b6f772ef4d0f90271ac77f8ed864656386822d2300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
            + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
            + "772e696e74656c2e636f6d301e170d3138313131343131313634305a170d323830393232313131363430"
            + "5a308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b53"
            + "616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d301b"
            + "060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777772e"
            + "696e74656c2e636f6d3076301006072a8648ce3d020106052b8104002203620004e88a78a24306520df3"
            + "c3901c3aa19bb6025c6e9264159eab43d106314693e41614896758b3193878d05fc8011a668be11e5375"
            + "571ebfe6f655cb78407f7cf8d90457bc03be461895a4d895a3ca63bb48202e7fe2777b7f8bbd7c76e5d2"
            + "4cce67a382012930820125306e06082b0601050507010104623060305e06082b06010505073002865268"
            + "747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f49"
            + "4f542f63657274732f494f545f43414b5f526f6f7443415f43657274696669636174652e636572301f06"
            + "03551d23041830168014ea64e85e9d1901e93b68d7eadf1143eb40417cb330120603551d130101ff0408"
            + "30060101ff020100304f0603551d1f044830463044a042a040863e68747470733a2f2f74727573746564"
            + "73657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63726c732f494f545f4341"
            + "4b2e63726c300e0603551d0f0101ff040403020106301d0603551d0e04160414f17b8586363c9b55c8f1"
            + "eea75a33288fb4ee8bfd300a06082a8648ce3d0403030366003063022f786682da8b61fff1e965decbef"
            + "da9025b52e47640bfed6caf8b3393ef3b6a34d89e89b6335f5e5a6b9595ed41ccb0402300825ebf7ee88"
            + "a06a513a542df8634318fe77049cad4a7bb3af216033e390385503769ea2c50ab9b667f7f5434a"
            + "abab9b");

  private static final byte[] NO_KEY_USAGE_LEAF_CERT =
    DatatypeConverter.parseHexBinary(
        "308202fc30820281a003020102021400a09b797f57bb942074a6aef727899209e980b4300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c"
            + "0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777"
            + "772e696e74656c2e636f6d301e170d3138313131343131313832315a170d323830393232313131383231"
            + "5a301d311b301906035504030c12496f542043414b207669643a3044444441413076301006072a8648ce"
            + "3d020106052b81040022036200049efe5bb5c38f08411937ae2cbde41a56571056194436f069f6729a0c"
            + "95ede3d4f90976b371dc6dcc699a94f9e9db01d0fb927a39f234d2461abad4431507214d832131b7fba2"
            + "bf070d9cf12aff6958f7910452ea1a2174516dd75fee1f059e4aa382011930820115306e06082b060105"
            + "0507010104623060305e06082b06010505073002865268747470733a2f2f747275737465647365727669"
            + "6365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63657274732f494f545f43414b5f526f"
            + "6f7443415f43657274696669636174652e636572301f0603551d23041830168014f17b8586363c9b55c8"
            + "f1eea75a33288fb4ee8bfd30120603551d130101ff040830060101ff020100304f0603551d1f04483046"
            + "3044a042a040863e68747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f"
            + "636f6e74656e742f494f542f63726c732f494f545f43414b2e63726c301d0603551d0e04160414066dcf"
            + "6de5acdfe50a019eb2bce0969121f4b0b8300a06082a8648ce3d04030303690030660231008fcc9468e0"
            + "a3ad3dc3d5d2ec42f70d9bf3a6c30d957ec9ac73e8473ffd26af7f41a446514f6c72a2c4eed6d91780d3"
            + "76023100b9634d5b698c8b231749bf9a5d3ed9a440a7bb64133fb2056ef8da288e25cae2cc563542edb5"
            + "f4199a9558ef0a4a97ea");

  private static final byte[] NO_DIGITAL_SIGNATURE_ROOT_CERT =
    DatatypeConverter.parseHexBinary(
        "308202983082021da00302010202146e1dcdc44c461e0e120ee340d64494bf7f75ccc6300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
            + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
            + "772e696e74656c2e636f6d301e170d3138313031303039333631355a170d323830383138303933363135"
            + "5a308183310b3009060355040613025553310b3009060355040813024341311430120603550407130b53"
            + "616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d301b"
            + "060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777772e"
            + "696e74656c2e636f6d3076301006072a8648ce3d020106052b8104002203620004399d2d79cc13381e26"
            + "c224a293a8272037421b4c580e839e9f4e03ccc6d7b19376c5e8639d826b165eff8be0b92236871de1b9"
            + "bbd554e3ad13015b7d80789164a4aaaa071b3158b5817f22c1e4601fe344f8bfaf5ce321811f8fbd5b62"
            + "a9f80ea350304e30090603551d230402300030120603551d130101ff040830060101ff020101300e0603"
            + "551d0f0101ff040403020106301d0603551d0e041604142f2185911c74008cdd951ca759a421f4fcb128"
            + "36300a06082a8648ce3d0403030369003066023100c21654fbb293b5a1cf0bb865aa63d09d54ac19a9cf"
            + "d801f6626e4a26ef541866dca3d05a5c96d6e1d7a990aa18641371023100d705c867d917f0b451e80ba7"
            + "222c6ee92b987334440567445941c4c8382cff9564f6dc3115445efc674b1f1a1f45d9c3");

  private static final byte[] NO_DIGITAL_SIGNATURE_ISSUER_CERT =
    DatatypeConverter.parseHexBinary(
        "30820373308202f8a003020102021400fc21da71f6203e3bb5d38c18ee6748c112b59b300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
            + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
            + "772e696e74656c2e636f6d301e170d3138313031303039333731375a170d323830383138303933373137"
            + "5a308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b53"
            + "616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d301b"
            + "060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777772e"
            + "696e74656c2e636f6d3076301006072a8648ce3d020106052b8104002203620004fdc38232e8197b3b6e"
            + "5ba91d0ca249aab3d29de4ad5b304cfb0c986653b8ec9e618bae918204410ea4ae05d04e221929153df7"
            + "205c840e2ddf64244c5b20fa3b8acdc8ea109522de927b80910f2213cd1e5ac14fa1cffdd01203aa9d73"
            + "38009ba382012930820125306e06082b0601050507010104623060305e06082b06010505073002865268"
            + "747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f49"
            + "4f542f63657274732f494f545f43414b5f526f6f7443415f43657274696669636174652e636572301f06"
            + "03551d230418301680142f2185911c74008cdd951ca759a421f4fcb1283630120603551d130101ff0408"
            + "30060101ff020100304f0603551d1f044830463044a042a040863e68747470733a2f2f74727573746564"
            + "73657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63726c732f494f545f4341"
            + "4b2e63726c300e0603551d0f0101ff040403020106301d0603551d0e0416041464cb77ba05f00adf9078"
            + "e372f113f682d5f89326300a06082a8648ce3d0403030369003066023100b6ed8a4b7ba689667cf1a717"
            + "8705ee0e9fef0526c19289ee94dbf93587cbefedcfcfa6ae0ab56061b136a7e1fead18d8023100e4742b"
            + "237fe03f3676016a861f8f656cbeab29f3edca57f4ae96abacfad73b60fbadbb74d673388fc09194c2f7"
            + "f6fdf8");

  private static final byte[] NO_DIGITAL_SIGNATURE_LEAF_CERT =
    DatatypeConverter.parseHexBinary(
        "3082030c30820291a003020102021455a618e1e96bd2f7d52a2e82616b0b582575f3b0300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c"
            + "0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777"
            + "772e696e74656c2e636f6d301e170d3138313031303039333734305a170d323830383138303933373430"
            + "5a301d311b301906035504030c12496f542043414b207669643a3044444441413076301006072a8648ce"
            + "3d020106052b81040022036200049c284ca00c258b8edc8698021906c2dfd67e879b6fad25433aa27820"
            + "4a44fbb96f749d754dec9af13ac6fcde6d8c5ffc12a233b7995cb100277d6800ed9a6018143bcf2473a5"
            + "9a5a7072e37788406aa5346d6b05a19e4dc210fc38966d65d264a382012930820125306e06082b060105"
            + "0507010104623060305e06082b06010505073002865268747470733a2f2f747275737465647365727669"
            + "6365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63657274732f494f545f43414b5f526f"
            + "6f7443415f43657274696669636174652e636572301f0603551d2304183016801464cb77ba05f00adf90"
            + "78e372f113f682d5f8932630120603551d130101ff040830060101ff020100304f0603551d1f04483046"
            + "3044a042a040863e68747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f"
            + "636f6e74656e742f494f542f63726c732f494f545f43414b2e63726c300e0603551d0f0101ff04040302"
            + "0106301d0603551d0e04160414d0ae387801e37f39c58b269fc0d9a93c261dc4d7300a06082a8648ce3d"
            + "0403030369003066023100e3f87fb620c029baa13c74364bd439cea712983315ad90b58b4bdd84c21525"
            + "eabf92dac6319626f5b032637eb78c31d3023100bcb54147443b28d8d2e509f7efb293f373e0131c3e49"
            + "4875ef590d0fd6f9dfca03e250849e5cf0429b96ddbea4514142");

  private static final byte[] KEY_256_CURVE_384_ROOT_CERT =
    DatatypeConverter.parseHexBinary(
        "3082025a30820200a00302010202147f4e3759f3743bbfff7100d5b9083747d94e7f1e300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
            + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
            + "772e696e74656c2e636f6d301e170d3138313131353133313435355a170d323830393233313331343535"
            + "5a308183310b3009060355040613025553310b3009060355040813024341311430120603550407130b53"
            + "616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d301b"
            + "060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777772e"
            + "696e74656c2e636f6d3059301306072a8648ce3d020106082a8648ce3d03010703420004bc259354f33f"
            + "0e2c0184a7561ff33212dbe88238fb4dd97a130612781cb10616b74e78bf6e93f2e440f375865d6b3192"
            + "e97e8a472c3516198738e57a78b93e49a350304e30090603551d230402300030120603551d130101ff04"
            + "0830060101ff020101300e0603551d0f0101ff040403020106301d0603551d0e0416041422ebea3b606b"
            + "d9336caadb5af87acc690d208623300a06082a8648ce3d0403030348003045022100d0cb95656d0fd093"
            + "ac65052a82e697f0691c9a558eb14bd42624fd81a6957d4702205d7d862eaa04c0fc22d57bf2cf026d8e"
            + "b7eec25ef782d1d51485a0e7b2870892");

  private static final byte[] KEY_256_CURVE_384_ISSUER_CERT =
    DatatypeConverter.parseHexBinary(
      "30820334308202dba00302010202143bc656a136620acf0bd67e5e05db6b2ffc4e2748300a06082a8648ce3d"
          + "040302308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
          + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
          + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
          + "772e696e74656c2e636f6d301e170d3138313131353133313531365a170d3238303932333133313531365"
          + "a308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b536"
          + "16e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d301b0"
          + "60355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777772e6"
          + "96e74656c2e636f6d3059301306072a8648ce3d020106082a8648ce3d03010703420004d083ec3f3a659"
          + "dbaabc76c9a6cc37d8397ab2ad04929c758ab0c7732293097d91eb6288c132aa02a7d72e1536adb5e6d5"
          + "9884ca9516036b75e41b62bb5aada5ba382012930820125306e06082b0601050507010104623060305e0"
          + "6082b06010505073002865268747470733a2f2f7472757374656473657276696365732e696e74656c2e6"
          + "36f6d2f636f6e74656e742f494f542f63657274732f494f545f43414b5f526f6f7443415f43657274696"
          + "669636174652e636572301f0603551d2304183016801422ebea3b606bd9336caadb5af87acc690d20862"
          + "330120603551d130101ff040830060101ff020100304f0603551d1f044830463044a042a040863e68747"
          + "470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f5"
          + "42f63726c732f494f545f43414b2e63726c300e0603551d0f0101ff040403020106301d0603551d0e041"
          + "60414d1ed5a53701951f32295af1c350951c7d47337a5300a06082a8648ce3d040302034700304402203"
          + "32b8d990c488375e7e41943348351f8f64add1dc3ec77dcaf924a60591c23b102201162caf2fff4d5927"
          + "ab407b14e5a84074257bfbe53ee3111bd8188685495896f");

  private static final byte[] KEY_256_CURVE_384_LEAF_CERT =
    DatatypeConverter.parseHexBinary(
      "308202be30820264a00302010202145d51959b22dd3e7af778655749a8873b04b1b9f1300a06082a8648ce3d"
          + "040302308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c"
          + "0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d"
          + "301b060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777"
          + "772e696e74656c2e636f6d301e170d3138313131353133313533395a170d323830393233313331353339"
          + "5a301d311b301906035504030c12496f542043414b207669643a3044444441413059301306072a8648ce"
          + "3d020106082a8648ce3d03010703420004056264a0ac0a906902131ac89b704c9ce72ae429c1def65ac5"
          + "baebab5b2d6cfcea95510391f30fb47f49f927ea843c8b885127ada04d86d91ebdd47a0fc38ff4a38201"
          + "1930820115306e06082b0601050507010104623060305e06082b06010505073002865268747470733a2f"
          + "2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f542f636572"
          + "74732f494f545f43414b5f526f6f7443415f43657274696669636174652e636572301f0603551d230418"
          + "30168014d1ed5a53701951f32295af1c350951c7d47337a530120603551d130101ff040830060101ff02"
          + "0100304f0603551d1f044830463044a042a040863e68747470733a2f2f74727573746564736572766963"
          + "65732e696e74656c2e636f6d2f636f6e74656e742f494f542f63726c732f494f545f43414b2e63726c30"
          + "1d0603551d0e0416041435bdea9e716fa9e0bac701506b97076798aa3a19300a06082a8648ce3d040302"
          + "0348003045022100e7a6a235e66f97a40e5715a1f7232894da5bcb48341a492ac696a1555fd5baa40220"
          + "4373cf31cc325ad9ed1404501cc115c169f9d18149b7cfe00ae99a0e631df9a9");

  private static final byte[] KEY_384_CURVE_256_ROOT_CERT =
    DatatypeConverter.parseHexBinary(
      "308202983082021da00302010202146e1c184be66f5f98b8ba392c1e45bd4d5c2536cd300a06082a8648ce3d"
          + "040302308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
          + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
          + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
          + "772e696e74656c2e636f6d301e170d3138313131353133333930365a170d323830393233313333393036"
          + "5a308183310b3009060355040613025553310b3009060355040813024341311430120603550407130b53"
          + "616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d301b"
          + "060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777772e"
          + "696e74656c2e636f6d3076301006072a8648ce3d020106052b81040022036200046751e429be7575ca35"
          + "6cc6f466c7e3e6cfe5b04daffc4f72f87c18c9436cc2c997b98e7ef84bea1a5b86447e5c2a27864413b7"
          + "0fcdf14bdf9a8f1571415f1bf3acf50b1c8db11cedceb04986a70f6d1e2400f8f061d8c907115ca237c9"
          + "78f277a350304e30090603551d230402300030120603551d130101ff040830060101ff020101300e0603"
          + "551d0f0101ff040403020106301d0603551d0e041604145df7cd309c292f1b97f5b7204806b2c6cdf8b1"
          + "12300a06082a8648ce3d0403020369003066023100f0c6b15c3c8135f4cdc9c8e58380704554be062442"
          + "0adc0d7deacfff36260983f6e73918db6fb22c6b3c8670d3ac4e58023100fcf6238a28c826eeaeb64058"
          + "5602931790ee9cc6f07be7ba6330da56721532e708e3c75ed136f3611927765eb921855f");

  private static final byte[] KEY_384_CURVE_256_ISSUER_CERT =
  DatatypeConverter.parseHexBinary(
      "30820372308202f8a00302010202147fbd66a761d2691e93b4e9ffa78219b32bf8c8ce300a06082a8648ce3d"
          + "040303308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
          + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
          + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
          + "772e696e74656c2e636f6d301e170d3138313131353133333930365a170d323830393233313333393036"
          + "5a308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b53"
          + "616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d301b"
          + "060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777772e"
          + "696e74656c2e636f6d3076301006072a8648ce3d020106052b8104002203620004f62241547e87b1fc42"
          + "f9f6bed72c1390e8c65b23660a3cd5f61d7f5ba49ef7445f78358917d5db3e70259236f1345c4c2e7e69"
          + "1e5e02d6d578e12482a214950bc524536ee0a1416d227c31117f9568bf8f8d6478080717204e36c45404"
          + "aa812da382012930820125306e06082b0601050507010104623060305e06082b06010505073002865268"
          + "747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f49"
          + "4f542f63657274732f494f545f43414b5f526f6f7443415f43657274696669636174652e636572301f06"
          + "03551d230418301680145df7cd309c292f1b97f5b7204806b2c6cdf8b11230120603551d130101ff0408"
          + "30060101ff020100304f0603551d1f044830463044a042a040863e68747470733a2f2f74727573746564"
          + "73657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63726c732f494f545f4341"
          + "4b2e63726c300e0603551d0f0101ff040403020106301d0603551d0e04160414ab76b5d930ead16b277f"
          + "d2582b22b1df78ac6552300a06082a8648ce3d0403030368003065023100f45136a2fa04066c5e50e871"
          + "e92c21fd308fabbc3d3b268aba2fe466f267dbb47adf862da3b55c81da7365f4f713147602300d0e48cf"
          + "0521aa11e4e918dfd49272a5d245940fd24ba3ecd8c2597126abf3de2a3d3e895e191e0d4033244ea2f1"
          + "c86c");

  private static final byte[] KEY_384_CURVE_256_LEAF_CERT =
  DatatypeConverter.parseHexBinary(
      "3082030b30820291a003020102021400e066a77410d38c5072224efcd41310b8df52b3300a06082a8648ce3d"
          + "040303308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c"
          + "0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d"
          + "301b060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777"
          + "772e696e74656c2e636f6d301e170d3138313131353133333930365a170d323830393233313333393036"
          + "5a301d311b301906035504030c12496f542043414b207669643a3044444441413076301006072a8648ce"
          + "3d020106052b810400220362000407ccec37cbb65887847fa03aac7929dbbe036f3c07455b17bdb4e103"
          + "1b7e3d8880dff5f6037b4baf50aa0214a9ffccc5725ebc4212041a037536f79c5d0e3e279de7cfd33967"
          + "ccd68a1ffd7b5757eaec8b420f359ae0d382aeb8e894bc52cddca382012930820125306e06082b060105"
          + "0507010104623060305e06082b06010505073002865268747470733a2f2f747275737465647365727669"
          + "6365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63657274732f494f545f43414b5f526f"
          + "6f7443415f43657274696669636174652e636572301f0603551d23041830168014ab76b5d930ead16b27"
          + "7fd2582b22b1df78ac655230120603551d130101ff040830060101ff020100304f0603551d1f04483046"
          + "3044a042a040863e68747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f"
          + "636f6e74656e742f494f542f63726c732f494f545f43414b2e63726c300e0603551d0f0101ff04040302"
          + "0106301d0603551d0e04160414beb47ad29e0c257b4f061cb41377cbedc51ae54b300a06082a8648ce3d"
          + "0403030368003065023100e7ed147b34714dc911c31b78b6695852903eddf2ba4d3d1f1c2daad2a70bf7"
          + "ff142b73c0000d89bf816cf6fc470d8d440230458e06bd850c13abf88f8b99663eed0ccf4c8d1640165d"
          + "bbdac7ea6b2108705c2631093b6fb262dc49015741d6d27141");

  private static final byte[] SIG_ALG_512_CURVE_521_ROOT_CERT =
    DatatypeConverter.parseHexBinary(
        "308202e230820243a00302010202145d0fe19a05e49f6beec179de8b12ce54b8f7ada3300a06082a8648ce3d"
            + "040304308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
            + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
            + "772e696e74656c2e636f6d301e170d3138313131353134353731315a170d323830393233313435373131"
            + "5a308183310b3009060355040613025553310b3009060355040813024341311430120603550407130b53"
            + "616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d301b"
            + "060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777772e"
            + "696e74656c2e636f6d30819b301006072a8648ce3d020106052b8104002303818600040139005ce1e8ed"
            + "c307aacb50ecb1417105f725ee08bd2e771242c848c5862a45d213089896f9f801922aff594beb12aa92"
            + "9512b76b527b002d207033a8cddc83ff8b019b67fa397c7ed14519abbc20f50db29578306172011e2af1"
            + "f766cb7cbaa715bcc2673e4f6ed836417e8161ec376f5b8b1a44c63f404b93167bcc1b019d2601d27ea3"
            + "50304e30090603551d230402300030120603551d130101ff040830060101ff020101300e0603551d0f01"
            + "01ff040403020106301d0603551d0e04160414c2b481b65d9df451de5ed242506aabe984f2b09b300a06"
            + "082a8648ce3d04030403818c00308188024201c1a23d958ce66c6f8955013e3871ab1494c21648a7a215"
            + "d25bd0a6e2e1830ceaea23669f51c1ca060834e8736ad4c749ac59fba3c81839cf530bea08d6ac881897"
            + "024201a0b79ada5d1c745aa248dddfe320f362eab8e98ac0b1fd6998ed42817a9dd1500de0a5f4a84660"
            + "0b5e94e77ea9a34eeaed2107d9c87084225b0ca0e04bb3ff2f45");

  private static final byte[] SIG_ALG_512_CURVE_521_ISSUER_CERT =
    DatatypeConverter.parseHexBinary(
        "308203bb3082031ea0030201020214449781118a226bc868d5657c0053ba47e35c36d2300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504081302434131143012060355040713"
            + "0b53616e746120436c617261311a3018060355040a1311496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b1314494f542043414b20526f6f74205369676e696e67311630140603550403130d7777"
            + "772e696e74656c2e636f6d301e170d3138313131353134353731315a170d323830393233313435373131"
            + "5a308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b53"
            + "616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d301b"
            + "060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777772e"
            + "696e74656c2e636f6d30819b301006072a8648ce3d020106052b81040023038186000400370dac2a78ef"
            + "cc81b6d4a79000fd9aa760d4cce79bbd3ee795742faf9f9923cbb7adb9b7b73832bae2fde3dc8cf4bdfe"
            + "fd21c8bfc0a7a6535eea979ab6747d7b6e015847416626b970713c31cfe73545119740a68fc31faae157"
            + "0c68cbb40f51906683d3a6bc0ed0b110768ad1c1e415ee5572b77fd251b58361bc02f36d6954e978dca3"
            + "82012930820125306e06082b0601050507010104623060305e06082b0601050507300286526874747073"
            + "3a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63"
            + "657274732f494f545f43414b5f526f6f7443415f43657274696669636174652e636572301f0603551d23"
            + "041830168014c2b481b65d9df451de5ed242506aabe984f2b09b30120603551d130101ff040830060101"
            + "ff020100304f0603551d1f044830463044a042a040863e68747470733a2f2f7472757374656473657276"
            + "696365732e696e74656c2e636f6d2f636f6e74656e742f494f542f63726c732f494f545f43414b2e6372"
            + "6c300e0603551d0f0101ff040403020106301d0603551d0e04160414f3ca772729fe6ed250fef7a04d9f"
            + "c3dc9f274bd5300a06082a8648ce3d04030303818a0030818602412a78e0eec69e7f7cf37ee87d7d9fce"
            + "fc0d83497dfed8f7270c36a17c9adea3e9d04e39fb8b5ddcd3668d56a77a1a56ade643bc62de936374d5"
            + "30193bd0286a3daf0241799efc859ebbe73bb262d95ae07ef8eb38da95f70b4974b4700355cb5409b405"
            + "3fb68f9dbc2fc4e897ba58675517ffcb977b22a985d61fe86b989fde0f0f1bda6c");

  private static final byte[] SIG_ALG_512_CURVE_521_LEAF_CERT =
    DatatypeConverter.parseHexBinary(
        "30820356308202b7a003020102021455f9b1c79e1b88d9254053310a33912ab3adfd01300a06082a8648ce3d"
            + "040303308183310b3009060355040613025553310b300906035504080c0243413114301206035504070c"
            + "0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e311d"
            + "301b060355040b0c14494f542043414b2049737375696e6720434120303116301406035504030c0d7777"
            + "772e696e74656c2e636f6d301e170d3138313131353134353731315a170d323830393233313435373131"
            + "5a301d311b301906035504030c12496f542043414b207669643a30444444414130819b301006072a8648"
            + "ce3d020106052b810400230381860004001b7445908ebfac9b8c7c7ff3eb03031a88174cad3d7d367e7b"
            + "05a6d7a6a1b2c0c622970bf480e58daa6274d17507527d29c9d68261aaa905136862e12af1f09406005b"
            + "2b117ab56014d0ad0283ccd6105fc8c434f3b8b195951a881dd71fa7297b00e3777bf3ddccf96a27ea81"
            + "3ab79fdfe3d19989ae2877b1d6855dfbf4a00dc93d49a382012930820125306e06082b06010505070101"
            + "04623060305e06082b06010505073002865268747470733a2f2f7472757374656473657276696365732e"
            + "696e74656c2e636f6d2f636f6e74656e742f494f542f63657274732f494f545f43414b5f526f6f744341"
            + "5f43657274696669636174652e636572301f0603551d23041830168014f3ca772729fe6ed250fef7a04d"
            + "9fc3dc9f274bd530120603551d130101ff040830060101ff020100304f0603551d1f044830463044a042"
            + "a040863e68747470733a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74"
            + "656e742f494f542f63726c732f494f545f43414b2e63726c300e0603551d0f0101ff040403020106301d"
            + "0603551d0e04160414eeea3ff1d86d1b6e4d61d7fdfc93d040db5e3fdb300a06082a8648ce3d04030303"
            + "818c00308188024201f0f78bb216cfa3563d18fc6381e98235e69e2ad4342885bea2034e6c3e1f60ce7d"
            + "3d3157f4b9ed435041cf9327846f195034fb5a8a4e388b2224c12a190682a015024201cf78030b4dd577"
            + "baaffc614eba7b5f9b7115c24cf85bd8c046af88deb11c547d32f2bcfa289f519a2f8da2573901dca9e6"
            + "741d96cbe76c0bd5aea40f71a855260a");

  private static final byte[] LEAF_CERT_RSA =
    DatatypeConverter.parseHexBinary(
      "308203543082023ca0030201020206016cbb28590d300d06092a864886f70d01010b05003045310b300906035"
          + "50406130241553113301106035504080c0a536f6d652d53746174653121301f060355040a0c18496e7465"
          + "726e6574205769646769747320507479204c7464301e170d3139303832323231303735395a170d3139303"
          + "832333231303735395a308190310b3009060355040613025553310b300906035504080c024f5231123010"
          + "06035504070c0948696c6c73626f726f311a3018060355040a0c11496e74656c20436f72706f726174696"
          + "f6e310d300b060355040b0c0449414753310c300a06035504030c0353444f3127302506092a864886f70d"
          + "01090116186b6172656e782e686572726f6c6440696e74656c2e636f6d30820122300d06092a864886f70"
          + "d01010105000382010f003082010a0282010100c3b4c8989afd183a00794fd361176f068a46de7b1c6855"
          + "29942284c32dbf7757cc6e215d3b1b270851c5b82601a0eda85a49861ab8b0720e14e94142234a1e983a8"
          + "50e882a6cf55560e225d158fbe4240681926ec471105a4027e574cd9795b004244045daff81d41e6bb6b9"
          + "d09ee0d3f6b6d3742f178145cd75269a67de1b58c1c187e9c34aa7b933a7bba659611ada43f768c45ee6b"
          + "8848fba69d0ba14be5a152a7fbcb9dfba4593acd8e5ad8419df3838a2a2c431479ad60c6c2e7a3d70a5d2"
          + "5febb7bed3c4fba055f3395e3715cf0da974511afffb2518f973beef7d6a1008e07f3b0955480b7622325"
          + "e2a8f1dc6571430fad827b47872bce24d27804d8d0203010001300d06092a864886f70d01010b05000382"
          + "010100255b12bd52b71e6b9597c580e684efed5c79ba2b3e9c02b7193f1d53b12bbeb70441617a6dc12ca"
          + "5d03e63e64d25a0e57b5307e1c62c3b1a0c239de557a39aef807b4c28f470452e4d7d229878a1d31f96ee"
          + "3f9ac92a509c717f01f16eee6a97255330f878bd05d33c038d1ab0233bf80315c4bf97eab197810a83710"
          + "baf0f07c39ec74570f777f253a9faee51d0294d71daee1f46ca4855c16e94bb84926dac03d830edc90f75"
          + "e27857d2ba63cad8274bef879074a664a0816ed5c6f477f18a07c6b1a66ae2e35aba85c781eb3a56638ca"
          + "0acb511f415241535b8bbde6f7d54d68eb1284e5dc8a4ab63cde2e4d4786be739bec48410e7f2b1eb75cc"
          + "9559b413");

  private static final byte[] ROOT_CERT_RSA =
    DatatypeConverter.parseHexBinary(
      "3082036b30820253a00302010202145cd9c415cda858b63a7cfbf20f00b1c7ec69c1d2300d06092a864886f70"
          + "d01010b05003045310b30090603550406130241553113301106035504080c0a536f6d652d537461746531"
          + "21301f060355040a0c18496e7465726e6574205769646769747320507479204c7464301e170d313930383"
          + "2323139313035385a170d3239303831393139313035385a3045310b300906035504061302415531133011"
          + "06035504080c0a536f6d652d53746174653121301f060355040a0c18496e7465726e65742057696467697"
          + "47320507479204c746430820122300d06092a864886f70d01010105000382010f003082010a0282010100"
          + "a9f8c8b46d56a5ec6d425872b62f7396aa09d3b57f6a29111c023d668ac21ef0274d009946c0f5c1a5abf"
          + "51e877c70c89c2b1848d5cfb59f6c9fb8727296f918f91f5081e8ba8f6530fac20f4ffef5bbd142be381f"
          + "159ca6ce4f8b794cc7d0a1369a3bb08e3fae6c46f653501539add358b1a2b8cc5804107fe7cc9936ab157"
          + "d499b474f23251ae2c5df8237a0e399e8be53289eda2803408b52f24d0f039f1735310c79590adaf12014"
          + "cbd834a9af7d4f2939ec51e690c537ff745eb146191a9cf8b040d8ae13cd7011867aa93e6afbda7f8ae1c"
          + "7ea3af24565a0d34f6b97f5f12caec45272420d345c6396aa5841cbeae5c195170d4a53d38e6beaf80a70"
          + "090203010001a3533051301d0603551d0e041604141dbe9da9451d971fa15a4a00d66d2b4d1beb5d0f301"
          + "f0603551d230418301680141dbe9da9451d971fa15a4a00d66d2b4d1beb5d0f300f0603551d130101ff04"
          + "0530030101ff300d06092a864886f70d01010b050003820101009808f6cad82ed0738020499e285a34d7a"
          + "412bf4e767f33eded5bd16035cc936d3b8c66be2abc44459e99e573ddc5ae9da8b7fa53451934c999b687"
          + "18d55e7224d23a8424f0b496e4b016f7357b49de37a86cf79c5741ca83efa268fb031ddff1acf2fd83e0c"
          + "3264ed5381d248ea72622425685efd575ce71b888f4d6215700aba70c67ef74eba55a7eb187b95da36723"
          + "e778421307ddd45d2b88a56306a8041bcfa133a0359961bbc167f2c81f9019e7f758c13b77fec7a768ccd"
          + "36c3ebc9b3fcd72ed240cdfe8a549d75c702e8f9c6844422cd511bd6009c3fff5e750af88420d26fffae5"
          + "808772cd712c1b2cd253b5247eea180d94508f602a049496609392");

  @InjectMocks private CertChainValidator certChainValidator;

  @BeforeMethod
  public void setUp() {
    MockitoAnnotations.initMocks(this);
  }

  @Test
  public void positive384testCertChainValidator() throws Exception {
    CertChain certChain = getCertChain(LEAF_CERT_384, ISSUER_CERT_384, ROOT_CERT_384);
    certChainValidator.validateCertChain(certChain);
  }

  @Test
  public void positive256testCertChainValidator() throws Exception {
    CertChain certChain = getCertChain(LEAF_CERT_256, ISSUER_CERT_256, ROOT_CERT_256);
    certChainValidator.validateCertChain(certChain);
  }

  @Test(expectedExceptions = FailedCertChainVerificationException.class)
  public void testCertChainValidatorMissingCertInChain() throws Exception {
    CertChain certChain = getCertChain(LEAF_CERT_384, ROOT_CERT_384);
    certChainValidator.validateCertChain(certChain);
  }

  @Test
  public void positiveTestCertChainWithoutKeyUsageExtension() throws Exception {
    CertChain certChain =
        getCertChain(NO_KEY_USAGE_LEAF_CERT, NO_KEY_USAGE_ISSUER_CERT, NO_KEY_USAGE_ROOT_CERT);
    certChainValidator.validateCertChain(certChain);
  }

  @Test(expectedExceptions = FailedCertChainVerificationException.class)
  public void testCertChainWithoutDigitalSignatureKeyUsageValidator() throws Exception {
    CertChain certChain =
        getCertChain(
            NO_DIGITAL_SIGNATURE_LEAF_CERT,
            NO_DIGITAL_SIGNATURE_ISSUER_CERT,
            NO_DIGITAL_SIGNATURE_ROOT_CERT);
    certChainValidator.validateCertChain(certChain);
  }

  @Test(expectedExceptions = FailedCertChainVerificationException.class)
  public void
      ifCertContains256KeyLengthAnd384CurveTypeCertChainVerificationExceptionShouldBeThrown()
          throws Exception {
    CertChain certChain =
        getCertChain(
            KEY_256_CURVE_384_ROOT_CERT,
            KEY_256_CURVE_384_ISSUER_CERT,
            KEY_256_CURVE_384_LEAF_CERT);
    certChainValidator.validateCertChain(certChain);
  }

  @Test(expectedExceptions = FailedCertChainVerificationException.class)
  public void
      ifCertContains384KeyLengthAnd256CurveTypeCertChainVerificationExceptionShouldBeThrown()
          throws Exception {
    CertChain certChain =
        getCertChain(
            KEY_384_CURVE_256_ROOT_CERT,
            KEY_384_CURVE_256_ISSUER_CERT,
            KEY_384_CURVE_256_LEAF_CERT);
    certChainValidator.validateCertChain(certChain);
  }

  @Test(expectedExceptions = FailedCertChainVerificationException.class)
  public void invalidSigAlgOrCurveShouldThrowFailedCertChainVerificationException()
      throws Exception {
    CertChain certChain =
        getCertChain(
            SIG_ALG_512_CURVE_521_ROOT_CERT,
            SIG_ALG_512_CURVE_521_ISSUER_CERT,
            SIG_ALG_512_CURVE_521_LEAF_CERT);
    certChainValidator.validateCertChain(certChain);
  }

  @Test(expectedExceptions = FailedCertChainVerificationException.class)
  public void
      invalidPublicKeyInsideDeviceAttestationShouldThrowFailedCertChainVerificationException()
          throws Exception {
    CertChain certChain = getCertChain(ROOT_CERT_RSA, LEAF_CERT_RSA);
    certChainValidator.validateCertChain(certChain);
  }

  private CertChain getCertChain(byte[]... certs) {
    return new CertChain(
        CertType.X509,
        (short) certs.length,
        Stream.of(certs).map(cert -> new Cert(cert.length, cert)).collect(Collectors.toList()));
  }
}
